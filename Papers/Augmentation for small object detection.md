# Augmentation for small object detection
## Abstract
这些年来，目标检测取得了令人瞩目的成就
尽管改进很大，但对于小目标和大目标的检测性能差异还是很大
在 MS COCO 数据集上分析了如今一个比较先进的算法，Mask-RCNN
发现小目标的 GT 和检测框之间 IOU 远小于期望的阈值（比如0.5）
我们推测这是由于两个因素
* 包含小目标的图片的数量很少
* 即使每张图片里都有小目标，这些小目标在整图中占比也太少了
  

因此提出两个方式
* 对这些包含小目标的图像进行 oversample
* 通过多次复制粘贴小目标的方式来 augment 包含小目标的每张图片

通过这种方式可以增强小目标的检测性能
实验了不同的 pasting augumentation 策略
最终，我们在实例分割任务上获得了 9.7% 的提升，在检测任务中获得了 7.1% 的性能提升

## Introdunction

目标检测是当今计算机视觉研究的基本任务之一，因为它往往是许多现实应用的起点，包括机器人和自动驾驶、卫星和航空图像分析，以及医学图像中器官和物体的定位

小目标检测是许多下游任务的关键
* 在自动驾驶领域，从汽车的高分辨率场景照片中检测小的或者远的物体是必要的。例如交通灯、行人通常在高分辨率图像中经过缩放后就瞅不见了
* 对于医疗图像，早期检测到肿块和肿瘤是准确诊断的关键，而在早期诊断时，这样的元素很容易只有几个像素
* 工业自动检测同样需要小目标检测来定位材料表面可见的小缺陷。对于卫星图像分析，图像中的目标例如车、船、马等都需要详细的标注

这些图像的分辨率范围为 0.5−5m，然而对应的目标则可能只有几十甚至几个像素。换句话说，随着更复杂的系统在现实世界中部署，小目标检测和分割需要更多的关注

MS COCO 目标检测大赛的第一名解决方案从2015年的 mAP=0.373 提升到了2017年的 mAP=0.525
在MS COCO实例分割挑战下的实例分割问题中也可以看到类似的进展
尽管有这些改进，现有的解决方案在处理小目标时往往表现不佳


>![1571295786916](1571295786916.png)
>界定目标大小划分规则

>![1571295799040](1571295799040.png)
>列举了几个实例分割算法的结果

明显看出各种模型在小目标和大目标的检测性能上的显著差距

 具体的，看看Mask-RCNN 的检测结果

>![1571295753008](1571295753008.png)
>来自Mask-RCNN的预测，系统遗漏了许多小物体，尽管在图中非常清晰
>在数百只鸟中只检测到六只鸟

这里，我们的实验室基于 MS COCO 数据集和 Mask R-CNN展开的
关于数据集，我们注意到它有两个特点

* 该数据集中包含小目标的图像相对较少，那么可能会导致训练出来的模型更关注于中、大目标的检测

* 小目标覆盖的面积很小，这意味着小目标出现的位置缺乏多样性
  我们目测，当模型较少的探索这些区域时，会使得检测模型很难推广到小目标

解决方式

-   对于第一个问题，我们通过对包含小目标的图像进行 oversampling 来解决

-   对于第二个问题，我们通过在每个包含小目标的图像中多次复制粘贴小目标来处理。复制目标时，我们确保不会和已经存在的目标有任何交叠。这增加了小目标位置的多样性，同时确保这些目标出现在正确的上下文中

    


>![1571296831162](1571296831162.png)
>通过复制粘贴小对象进行人工增强的示例
>正如在这些示例中所观察到的，粘贴同一图像很有可能会正确显示小对象的周围环境

##  Related Work

### Object Detection

Faster RCNN R-FCN SSD

### Instance Segmentation

### Small objects



## Identifying issues with detecting small objects

 这一节，首先概述 MS COCO 数据和实验中用到的目标检测方法，然后讨论 MS COCO 数据集和使用 anchor 类方法的问题。它们都是增加小目标检测难度的原因 

### MS COCO

我们使用 MS COCO 检测数据集进行了实验，MS COCO 2017 检测数据集包含 118287 张训练图片、5000 张验证图片和 40670 张测试图片。包含了 80 个类别的 860,001 和 36,781 个目标用 ground-truth 边界框和实例掩码进行了标注。

　　在 MS COCO 检测任务中,主要的评价指标是平均精度(AP),AP 是 precision/recall 曲线的一种定量表达。一个 TP,不仅要分类正确还要回归足够好，比如检测框和 GT 的 交并比 (IoU) 要大于0.5。AP分数是80个类别和10个IoU阈值的平均值，平均分布在0.5和0.95之间。 指标还包括在不同对象比例下测量的测量的AP。 本文中, 我们首要关注的是小目标的 AP。

### Mask R-CNN

本实验利用 Detectron[19] 框架下的 Mask R-CNN 实现，使用 ResNet-50 backbone 和 [20] 中提出的线性缩放规则来设置学习超参数。我们设置初始学习率 0.01，利用分布式 GPUs 训练迭代 36k次。优化方面，我们使用动量设置为0.9的随机梯度下降和系数设置为0.0001的权重衰减。 训练过程中学习率分别在 24K 和 32K 次时按照 0.1 的比例降低两次。其他参数设置参考 Detectron - Mask R-CNN+FPN+ResNet-50 下的设置。

在我们的调研中发现候选区域阶段特别重要。我们采用 FPN 来生成 object proposals。它定义了 5 个尺度(32<sup>2</sup>\64<sup>2</sup>\128<sup>2</sup>\256<sup>2</sup>\512<sup>2</sup>) 3 个宽高比(1\0:5\2) 一共 15 个anchor 来构成 object proposals.与GT的IoU≥0.7的anchor或者 GT 能匹配到的最大IoU的anchor作为正样本

### Small object detection by Mask R-CNN on MS COCO

 　在 MS COCO 中，训练集中出现的所有目标中有 41.43%41.43% 是小的，而只有 34.4%34.4% 和 24.2%24.2% 分别是中型和大型目标。另一方面，只有约一半的训练图片包含任何小物体，而 70.07%70.07% 和 82.28%82.28% 的训练图像分别包含中型和大型物体。这说明了小对象检测问题背后的第一个问题：使用小对象的示例较少。 ![1571298913967](1571298913967.png)

## Oversampling and Augmentation
## Experimental Setup
### Oversampling
### Augmentation
### Copy-Pasting Strategies
### Pasting Algorithms
## Result and Analysis
### Oversampling
### Augmentation
### Copy-Pasting strategies
### Pasting Algorithms
## Conclusion

## References

